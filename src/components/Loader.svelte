<script>
	import { draw, fade } from 'svelte/transition';
	import { quintOut } from 'svelte/easing';
	import { onMount } from 'svelte';
	
	let step = 0;
	onMount(() => {
		setTimeout(() => {
			step = 1;
		}, 10);
		setTimeout(() => {
			step = 2;
		}, 400);
		setTimeout(() => {
			step = 3;
			setLoaderReady()
		}, 1400);
	});

	export let loaded;
	export let setLoaderReady;
</script>

{#if step < 3 || !loaded}
	<div
		id="loader"
		class="h-screen w-screen absolute top-0 left-0 text-white flex items-center overflow-hidden z-20"
		style="background-color: #881229"
		out:fade={{ duration: 250 }}
	>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="100 100 870 870"
			class="w-32 h-32 flex-auto"
		>
			{#if step == 1}
				<path
					in:draw={{ duration: 1500, easing: quintOut }}
					out:fade={{ duration: 500 }}
					stroke="currentColor"
					fill="none"
					stroke-width="15px"
					d="M641.72,643.77c24.18.71,43.16-8.84,59.18-25,10-10.1,17.21-22,20.3-36.08,5.14-23.41-4.81-42.42-27.79-49.24-26.58-7.88-52.73-5.47-77.18,8.5a44.86,44.86,0,0,0-18.71,20.74c-13.39,28.62-27.06,57.12-41.3,85.33a73.38,73.38,0,0,1-15.16,20.14c-18,16.8-41.41,4-46-15-2.49-10.35-5.18-20.68-7-31.15-7.17-40.48-14-81-21-121.51-4.35-25.25-8.69-50.51-14.07-76-.54,1.36-1.17,2.69-1.61,4.08-15.12,48.5-33.17,95.87-55.37,141.59-15.23,31.38-32.09,61.8-55.92,87.7-10.08,11-21,21.07-35.1,26.68-7.49,3-15.28,4.88-23.39,2.59-17.88-5-22.51-20.73-10-34.39a35.33,35.33,0,0,1,8.65-6.64c10.57-6,21.38-11.55,31.95-17.52A94.34,94.34,0,0,0,350,589.91c20.6-38.69,37.81-78.9,53.87-119.59,18.26-46.25,35.59-92.87,53.11-139.41,3-7.86,7.82-13.09,16-14.8,11.2-2.34,19.44,2.47,22.88,14a237.9,237.9,0,0,1,6,25.74q12.25,67,24.2,134.12,8,44.46,16.06,88.92c.23,1.28.71,2.51,1.33,4.63,6.16-12,11.93-23.43,17.8-34.76,32.54-62.81,64.67-125.83,102.81-185.53,9.77-15.31,19.73-30.53,33.29-42.9,8.53-7.77,18.59-10.39,29.65-7s14.16,14,6.66,22.81c-9.81,11.55-20.15,22.65-30,34.16a298.7,298.7,0,0,0-39,59.06c-13.06,25.63-26.61,51-40.53,77.59,5.94-1.29,10.63-2.51,15.39-3.31,29-4.9,57.48-4.08,84.34,9.54,37.68,19.09,50.15,61.66,28.75,98.15-13.5,23-34.14,38-57.93,48.75-11.6,5.24-23.94,8.83-36.69,13.43.8,3,1.37,7.13,3,10.81,5.09,11.52,10,23.14,16,34.21,7.91,14.65,21,18.21,36.63,15.07,17-3.41,30.76-12,42.12-25a28.65,28.65,0,0,1,10.1-7.62c5.79-2.38,11.79,1.87,11.07,8-.62,5.23-1.92,11.39-5.2,15.13-18.73,21.29-41.07,36.79-70.22,40.15-16.68,1.93-29.81-4.81-41-16.48-14.46-15.12-23-33.69-30.48-52.85-2.71-6.95-5.06-14-8-22.28-2.57,6.92-4.76,12.94-7,18.92-5.7,14.91-10.7,30.15-17.45,44.57-4.29,9.18-10.62,17.62-17.19,25.43-2.85,3.4-8.44,5.71-13,6.2-14.36,1.55-22.41-9.41-19.07-25.17a34.36,34.36,0,0,1,3.35-9.35c22.64-41.1,45.08-82.32,68.32-123.09,6.29-11,14.87-20.81,22.83-30.82a24.35,24.35,0,0,1,9.26-6.5,9.06,9.06,0,0,1,12.91,8.09,29,29,0,0,1-1.7,11.7c-6,15.13-12.51,30.07-18.84,45.08C643.64,639.47,642.82,641.25,641.72,643.77Z"
				/>
			{/if}
			{#if step > 1}
				<path
					in:fade={{ duration: 500 }}
					fill="currentColor"
					d="M641.72,643.77c24.18.71,43.16-8.84,59.18-25,10-10.1,17.21-22,20.3-36.08,5.14-23.41-4.81-42.42-27.79-49.24-26.58-7.88-52.73-5.47-77.18,8.5a44.86,44.86,0,0,0-18.71,20.74c-13.39,28.62-27.06,57.12-41.3,85.33a73.38,73.38,0,0,1-15.16,20.14c-18,16.8-41.41,4-46-15-2.49-10.35-5.18-20.68-7-31.15-7.17-40.48-14-81-21-121.51-4.35-25.25-8.69-50.51-14.07-76-.54,1.36-1.17,2.69-1.61,4.08-15.12,48.5-33.17,95.87-55.37,141.59-15.23,31.38-32.09,61.8-55.92,87.7-10.08,11-21,21.07-35.1,26.68-7.49,3-15.28,4.88-23.39,2.59-17.88-5-22.51-20.73-10-34.39a35.33,35.33,0,0,1,8.65-6.64c10.57-6,21.38-11.55,31.95-17.52A94.34,94.34,0,0,0,350,589.91c20.6-38.69,37.81-78.9,53.87-119.59,18.26-46.25,35.59-92.87,53.11-139.41,3-7.86,7.82-13.09,16-14.8,11.2-2.34,19.44,2.47,22.88,14a237.9,237.9,0,0,1,6,25.74q12.25,67,24.2,134.12,8,44.46,16.06,88.92c.23,1.28.71,2.51,1.33,4.63,6.16-12,11.93-23.43,17.8-34.76,32.54-62.81,64.67-125.83,102.81-185.53,9.77-15.31,19.73-30.53,33.29-42.9,8.53-7.77,18.59-10.39,29.65-7s14.16,14,6.66,22.81c-9.81,11.55-20.15,22.65-30,34.16a298.7,298.7,0,0,0-39,59.06c-13.06,25.63-26.61,51-40.53,77.59,5.94-1.29,10.63-2.51,15.39-3.31,29-4.9,57.48-4.08,84.34,9.54,37.68,19.09,50.15,61.66,28.75,98.15-13.5,23-34.14,38-57.93,48.75-11.6,5.24-23.94,8.83-36.69,13.43.8,3,1.37,7.13,3,10.81,5.09,11.52,10,23.14,16,34.21,7.91,14.65,21,18.21,36.63,15.07,17-3.41,30.76-12,42.12-25a28.65,28.65,0,0,1,10.1-7.62c5.79-2.38,11.79,1.87,11.07,8-.62,5.23-1.92,11.39-5.2,15.13-18.73,21.29-41.07,36.79-70.22,40.15-16.68,1.93-29.81-4.81-41-16.48-14.46-15.12-23-33.69-30.48-52.85-2.71-6.95-5.06-14-8-22.28-2.57,6.92-4.76,12.94-7,18.92-5.7,14.91-10.7,30.15-17.45,44.57-4.29,9.18-10.62,17.62-17.19,25.43-2.85,3.4-8.44,5.71-13,6.2-14.36,1.55-22.41-9.41-19.07-25.17a34.36,34.36,0,0,1,3.35-9.35c22.64-41.1,45.08-82.32,68.32-123.09,6.29-11,14.87-20.81,22.83-30.82a24.35,24.35,0,0,1,9.26-6.5,9.06,9.06,0,0,1,12.91,8.09,29,29,0,0,1-1.7,11.7c-6,15.13-12.51,30.07-18.84,45.08C643.64,639.47,642.82,641.25,641.72,643.77Z"
				/>
			{/if}
		</svg>
	</div>
{/if}